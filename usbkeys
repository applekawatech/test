run_hook() {
    echo "Running usbkeys hook..."

    # Create a unique mount point directory
    mount_point=$(mktemp -d /tmp/usbkey.XXXXXX)

    # Scan and mount all USB devices
    for dev in /dev/disk/by-id/usb*; do
        echo "Trying to mount USB device: $dev"
        if mount -t auto "$dev" "$mount_point" 2>/dev/null; then
            echo "USB key mounted at $mount_point"
            break
        else
            echo "Failed to mount: $dev"
        fi
    done

    if mountpoint -q "$mount_point"; then
        # Copy the key file if found
        if [ -f "$mount_point/Ilovemasa.py" ]; then
            echo "Key file found, copying to /tmp..."
            cp -f "$mount_point/Ilovemasa.py" /tmp/Ilovemasa.py
        else
            echo "Key file not found on USB key"
            rm -rf "$mount_point"
            exit 1
        fi

        # Unmount USB key
        echo "Unmounting USB key..."
        umount "$mount_point"
        rm -rf "$mount_point"
    else
        echo "No USB key mounted"
        exit 1
    fi
}
